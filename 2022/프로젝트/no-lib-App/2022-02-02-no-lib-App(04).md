---
date: '2022-02-02'
title: 'ë¼ì´ë¸ŒëŸ¬ë¦¬, í”„ë ˆì„ì›Œí¬ ì—†ì´ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸° (4) - Core: RouterLink'
categories: ['Project']
---

# âœ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬, í”„ë ˆì„ì›Œí¬ ì—†ì´ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸° (4)

## Core: RouterLink

<div>
  <h3 style="font-weight: 700">ëª©ì°¨</h3>
  <a href="#routerlink--main">1. ë©”ì¸</a>&nbsp;&nbsp;
  <hr/>
</div>

<h3 id="routerlink--main">1. index.ts (Router - ë©”ì¸)</h3>

`./core/RouterLink/index.ts`

**1) imports**

```ts
import Component, { Props, TargetType, ComponentItemType } from '../Component';
import { renderPath } from '../Router';
import { Publisher } from '../Store';
import './style.scss';
```

**2) Types**

```ts
type DefaultLinkProps = Pick<HTMLAnchorElement, 'href' | 'text'> & Partial<Pick<HTMLAnchorElement, 'name'>>;
export interface RouterLinkProps<T = unknown> extends Props, DefaultLinkProps {
  componentInfo: ComponentItemType;
  isButton?: boolean;
  publisherList?: Publisher[];
  callbackOption?: {
    func: () => Promise<T> | T;
    runPosition: 'beforeRenderPath' | 'afterRenderPath';
    options?: { isID: boolean };
  };
}
```

- **`RouterLinkProps`**: Link ì»´í¬ë„ŒíŠ¸ ìƒì„± ì‹œ, í•„ìš”í•œ ì†ì„±ë“¤ (**RouterLink** ì»´í¬ë„ŒíŠ¸ì˜ **Props**)
  - `componentInfo`: ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ í´ë¦­í–ˆì„ ë•Œ ì´ë™ë  ì»´í¬ë„ŒíŠ¸ì˜ ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” í”„ë¡œí¼í‹°.
  - `isButton`: í•´ë‹¹ ì˜µì…˜ì´ `true`ë¼ë©´, ì¼ë°˜ì ì¸ anchor íƒœê·¸ì˜ ë””ìì¸ì´ ì•„ë‹Œ ë²„íŠ¼ì˜ ë””ìì¸ ì ìš©
  - `publisherList`: ëª¨ë“  **Publisher**ì˜ ë“±ë¡ëœ ê°ì¢… í•¨ìˆ˜ë“¤ì„ ì´ˆê¸°í™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©
  - `callbackOption`: í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒ ì‹œ ì‹¤í–‰ ë„ì¤‘ì— ë”°ë¡œ ì²˜ë¦¬í•´ì•¼ í•  ë¡œì§ì´ ìˆë‹¤ë©´ ì‚¬ìš©
    - **_ì˜ˆ)_** ì„œë²„ì™€ì˜ í†µì‹  (ë¹„ë™ê¸° ìš”ì²­) ë„ì¤‘ì— ì‹¤íŒ¨í–ˆë‹¤ë©´, Link ì»´í¬ë„ŒíŠ¸ê°€ ì‘ë™í•´ì„œëŠ” ì•ˆë¨.  
      ğŸ‘‰ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ë„˜ì–´ê°€ë©´ ì•ˆë˜ëŠ” ìƒí™©ì´ ìˆì„ ë•Œ ì‚¬ìš©.

**3) Class**

```ts
/**
 * [RouterLink]
 * - a íƒœê·¸ë¥¼ í†µí•œ í˜ì´ì§€ ì´ë™ ì»´í¬ë„ŒíŠ¸ (Component ìƒì† & Router ì¼ë¶€ ì‚¬ìš©)
 */
class RouterLink extends Component<{}, RouterLinkProps> {
  constructor(protected readonly $target: TargetType, protected props: RouterLinkProps) {
    super($target, props);
  }
  protected setTemplate(): string {
    if (!this.props) return '';
    const { componentId, props } = this;
    const { text, isButton } = props;

    const excludeStrs = ['routerInfo', 'publisherList', 'isButton', 'callbackOption', 'text'];
    const strAttrs = this.createStringAttribute(...excludeStrs);
    const strClassName = `${isButton ? ' btn' : ''}`;

    return `<a class="app-link ${strClassName}" ${strAttrs} data-component-id=${componentId}>${text ?? ''}</a>`;
  }
  protected setEvents(): void {
    this.registerAnchorClick();
  }

  // =====

  private registerAnchorClick(): void {
    this.getEventTarget()?.addEventListener('click', (e) => this.anchorClickHandler(e));
  }

  private async anchorClickHandler(e?: MouseEvent | Event): Promise<void> {
    e?.preventDefault();
    const $target = e?.target as HTMLElement;
    const $currentTarget = e?.currentTarget as HTMLAnchorElement;
    if (!$currentTarget || $target !== $currentTarget) return;
    let href = $currentTarget.href;
    if (!href) return;

    const { callbackOption: cb } = this.props;
    if (cb?.func && cb.runPosition === 'beforeRenderPath') {
      const execFunc = await cb.func();

      const isBooleanFunc = typeof execFunc === 'boolean';
      if (isBooleanFunc && !execFunc) return;

      if (cb.options?.isID) {
        const isNumberFunc = typeof execFunc === 'number';
        if (isNumberFunc && execFunc === -1) return;
        href += `?id=${execFunc}`;
      }
    }

    const { componentInfo, publisherList } = this.props;
    const calledComponentName = `${this.constructor.name}(${this.componentId})`;
    renderPath({ componentInfo, href, calledComponentName, publisherList });
    if (cb?.func && cb.runPosition === 'afterRenderPath') cb.func();
  }
}

export default RouterLink;
```

- **`anchorClickHandler`** ì˜ ì²˜ë¦¬ ê³¼ì •  
  **1)** í˜„ì¬ í´ë¦­ëœ targetì´ RouterLink ê°œì²´ì¸ì§€ í™•ì¸, href ì†ì„±ì— ê°’ì´ ìˆëŠ”ì§€ í™•ì¸.  
  **2)** `props.callbackOption`ì´ ìˆì„ ì‹œ `callbackOption`ì˜ `runPosition`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ `callbackOption.func()` ì‹¤í–‰
  - **"beforeRenderPath"**: `renderPath`ê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ì‹¤í–‰.
    - `props.options.isID` ì˜µì…˜ì´ ìˆê³ , `func()`ì˜ ë°˜í™˜ê°’ì´ _number_ ì¸ ê²½ìš° hrefì— ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ê°’ ì¶”ê°€.  
      ğŸ‘‰ DetailPageë¡œ ì´ë™í•  ë•Œ ì‚¬ìš©
      > íŠ¹ì • í˜ì´ì§€ë¥¼ ìœ„í•œ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ ê°’ì„ ë„£ëŠ” ê²ƒì´ë¼, ì´ ë¶€ë¶„ì€ ë‹¤ë¥¸ ë°©ì•ˆì´ ìˆë‹¤ë©´ ë³€ê²½í•˜ê¸°.
    - `func()`ì˜ ë°˜í™˜ê°’ íƒ€ì…ì´ _boolean_ ì´ë©° ë°˜í™˜ê°’ì´ falseë¼ë©´ `anchorClickHandler` ì‹¤í–‰ ì¤‘ë‹¨.
  - **"afterRenderPath"**: `renderPath` ì‹¤í–‰ ì´í›„ì— ì‹¤í–‰
